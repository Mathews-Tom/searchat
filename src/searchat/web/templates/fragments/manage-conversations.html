{% if conversations %}
<div class="results-header">
    {{ total }} conversation{{ 's' if total != 1 else '' }}
    {% if page > 1 %} &middot; Page {{ page }} of {{ total_pages }}{% endif %}
</div>

{% for c in conversations %}
<div class="result manage-result" id="manage-{{ c.conversation_id }}">
    <label class="manage-checkbox">
        <input type="checkbox" name="cid" value="{{ c.conversation_id }}">
        <span class="manage-checkmark"></span>
    </label>
    <div class="manage-result-content">
        <div class="result-title">{{ c.title or 'Untitled' }}</div>
        <div class="result-meta">
            <span>{{ c.project_id }}</span>
            {% if c.message_count %}
            <span>&middot; {{ c.message_count }} messages</span>
            {% endif %}
            {% if c.updated_at %}
            <span>&middot; {{ c.updated_at[:10] if c.updated_at is string else c.updated_at.strftime('%Y-%m-%d') }}</span>
            {% endif %}
            {% if c.tool %}
            <span class="manage-tool-badge manage-tool-{{ c.tool }}">{{ c.tool }}</span>
            {% endif %}
        </div>
        {% if c.display_path %}
        <div class="manage-source-path" title="{{ c.file_path }}">{{ c.display_path }}</div>
        {% endif %}
    </div>
    <button class="glass-btn manage-preview-btn"
            title="Preview conversation"
            hx-get="/fragments/conversation-preview/{{ c.conversation_id }}"
            hx-target="#previewContent"
            hx-indicator="#previewSpinner"
            onclick="openPreviewPanel()">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/>
        </svg>
    </button>
</div>
{% endfor %}

{% if total_pages > 1 %}
<div class="manage-pagination">
    {% if page > 1 %}
    <button class="glass-btn"
            hx-get="/fragments/manage-conversations?page={{ page - 1 }}&sortBy={{ sort_by }}&project={{ project }}&tool={{ tool }}&date={{ date }}"
            hx-target="#manage-list">
        &larr; Previous
    </button>
    {% endif %}
    <span class="manage-page-info">Page {{ page }} of {{ total_pages }}</span>
    {% if page < total_pages %}
    <button class="glass-btn"
            hx-get="/fragments/manage-conversations?page={{ page + 1 }}&sortBy={{ sort_by }}&project={{ project }}&tool={{ tool }}&date={{ date }}"
            hx-target="#manage-list">
        Next &rarr;
    </button>
    {% endif %}
</div>
{% endif %}

{% else %}
<div class="result" style="padding: 48px; text-align: center;">
    <p style="color: hsl(var(--text-tertiary)); margin: 0;">No conversations found.</p>
</div>
{% endif %}
