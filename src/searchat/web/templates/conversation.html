{% extends "base.html" %}

{% block title %}Searchat - Conversation{% endblock %}

{% block head %}
    <style>
        body {
            font-family: var(--font-sans);
            font-size: 16px;
            line-height: 1.6;
            max-width: 1000px;
            margin: 0 auto;
            padding: 24px;
            background: hsl(var(--bg-base));
            color: hsl(var(--text-primary));
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            position: relative;
        }

        .back-button {
            font-family: var(--font-sans);
            padding: 10px 20px;
            background: hsl(var(--accent));
            color: hsl(var(--text-inverse));
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            display: inline-block;
            margin-bottom: 24px;
            border-radius: var(--radius-md);
            transition: background-color var(--transition-fast);
        }

        .back-button:hover { background: hsl(var(--accent-hover)); }

        .conv-header {
            background: hsl(var(--bg-glass));
            backdrop-filter: blur(var(--blur-glass)) saturate(1.3);
            padding: 20px;
            margin-bottom: 24px;
            border: 1px solid hsl(var(--border-glass));
            border-left: 3px solid hsl(var(--accent));
            border-radius: var(--radius-md);
        }

        .conv-header h2 {
            font-family: var(--font-sans);
            color: hsl(var(--text-primary));
            margin: 0 0 12px 0;
            font-size: 24px;
            font-weight: 600;
        }

        .conv-header div { color: hsl(var(--text-tertiary)); font-size: 14px; }
        .message {
            background: hsl(var(--bg-glass));
            backdrop-filter: blur(var(--blur-glass)) saturate(1.3);
            border: 1px solid hsl(var(--border-glass));
            border-left: 3px solid transparent;
            border-radius: var(--radius-md);
            padding: 20px;
            margin-bottom: 20px;
        }
        .message.user { border-left-color: hsl(var(--success)); }
        .message.assistant { border-left-color: hsl(var(--accent)); }
        .role {
            font-family: var(--font-sans);
            font-weight: 600;
            color: hsl(var(--text-tertiary));
            margin-bottom: 12px;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .content {
            white-space: pre-wrap;
            font-family: var(--font-sans);
            color: hsl(var(--text-primary));
            font-size: 16px;
            line-height: 1.6;
        }
        .tool-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: var(--radius-pill);
            font-size: 12px;
            font-weight: 600;
            font-family: var(--font-sans);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 10px;
        }
        .tool-badge.claude { background: hsl(var(--accent) / 0.15); color: hsl(var(--accent)); }
        .tool-badge.vibe { background: hsl(var(--warning) / 0.15); color: hsl(var(--warning)); }
        .header-actions { display: flex; gap: 8px; margin-top: 12px; flex-wrap: wrap; }
        .download-btn, .resume-btn {
            font-family: var(--font-sans);
            padding: 8px 14px;
            background: hsl(var(--accent));
            color: hsl(var(--text-inverse));
            border: none;
            border-radius: var(--radius-md);
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            transition: all var(--transition-fast);
        }
        .download-btn:hover { background: hsl(var(--accent-hover)); }
        .resume-btn { background: hsl(var(--success)); }
        .resume-btn:hover:not(:disabled) { filter: brightness(1.1); }
        .resume-btn:disabled { opacity: 0.7; cursor: wait; }
        .loading { text-align: center; padding: 40px; color: hsl(var(--text-tertiary)); }
    </style>
{% endblock %}

{% block body %}
    <!-- Theme Switcher -->
    <div class="theme-switcher" id="themeSwitcher" style="position: absolute; top: 0; right: 0; display: flex; padding: 3px; border-radius: 10px; background: hsl(var(--bg-surface)); gap: 2px; z-index: 100;">
        <button class="theme-switcher-btn" title="Light" @click="$store.theme.set('light')"
                :class="{ active: $store.theme.mode === 'light' }">
            <svg width="14" height="14" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"><circle cx="8" cy="8" r="3"/><path d="M8 1v2M8 13v2M1 8h2M13 8h2M3.05 3.05l1.41 1.41M11.54 11.54l1.41 1.41M3.05 12.95l1.41-1.41M11.54 4.46l1.41-1.41"/></svg>
        </button>
        <button class="theme-switcher-btn" title="Dark" @click="$store.theme.set('dark')"
                :class="{ active: $store.theme.mode === 'dark' }">
            <svg width="14" height="14" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M13.5 8.5a5.5 5.5 0 1 1-7-7 4.5 4.5 0 0 0 7 7z"/></svg>
        </button>
        <button class="theme-switcher-btn" title="Auto" @click="$store.theme.set('auto')"
                :class="{ active: $store.theme.mode === 'auto' }">
            <svg width="14" height="14" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="1" y="2" width="14" height="10" rx="1.5"/><path d="M5 15h6M8 12v3"/></svg>
        </button>
    </div>

    <a href="/" class="back-button">Back to Search</a>
    <div id="conversation"
         hx-get="/fragments/conversation-view/{{ conversation_id }}"
         hx-trigger="load"
         hx-target="this">
        <div class="loading">Loading conversation...</div>
    </div>
{% endblock %}
